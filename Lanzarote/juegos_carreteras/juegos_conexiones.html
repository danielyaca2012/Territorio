<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Juego de carreteras ‚Äì Lanzarote</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: Arial, Helvetica, sans-serif;
  background: linear-gradient(135deg, #0b7, #0a5);
  color: #042;
}

#contenedor {
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

h1 {
  text-align: center;
}

.caja {
  background: white;
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}

input, textarea {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  font-size: 1rem;
}

button {
  padding: 10px 15px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: #0b7;
  color: white;
  font-size: 1rem;
}

button:hover {
  background: #099;
}

.controles {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 15px;
  flex-wrap: wrap;
}

.correcto { color: green; }
.incorrecto { color: red; }

#mapa {
  height: 300px;
  border-radius: 12px;
}
</style>
</head>

<body>

<div id="contenedor">

<h1>üõ£Ô∏è Juego de carreteras</h1>

<div class="caja">
  <strong id="nombreCarretera">‚Äî</strong><br>
  <span id="descripcion"></span>
</div>

<div class="caja">
  <strong>üìç Municipios (separados por coma)</strong>
  <textarea id="inputMunicipios"></textarea>
  <div id="resultadoMunicipios"></div>
</div>

<div class="caja">
  <strong>üèòÔ∏è Pasa por (separados por coma)</strong>
  <textarea id="inputPasaPor"></textarea>
  <div id="resultadoPasaPor"></div>
</div>

<div class="caja">
  <strong>‚ñ∂ Inicio:</strong> <span id="inicio">‚Äî</span><br>
  <strong>‚èπ Final:</strong> <span id="final">‚Äî</span>
</div>

<div class="caja">
  <div id="mapa"></div>
</div>

<div class="controles">
  <button onclick="corregir()">‚úÖ Corregir</button>
  <button onclick="mostrarSolucion()">üëÅ Mostrar soluci√≥n</button>
  <button onclick="anterior()">‚¨Ö Anterior</button>
  <button onclick="siguiente()">Siguiente ‚û°</button>
</div>

</div>

<script src="data_carreteras.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
// ===============================
// DATOS Y ESTADO
// ===============================
const claves = Object.keys(dataCarreteras);
let indice = 0;

// ===============================
// MAPA
// ===============================
const mapa = L.map('mapa').setView([29.05, -13.63], 10);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap'
}).addTo(mapa);

let capaCarretera = null;

// ===============================
// L√ìGICA DEL JUEGO
// ===============================
function mostrarCarretera() {
  const c = dataCarreteras[claves[indice]];

  document.getElementById("nombreCarretera").textContent = c.nombre;
  document.getElementById("descripcion").textContent = c.descripcion;
  document.getElementById("inicio").textContent = "‚Äî";
  document.getElementById("final").textContent = "‚Äî";

  document.getElementById("inputMunicipios").value = "";
  document.getElementById("inputPasaPor").value = "";

  document.getElementById("resultadoMunicipios").textContent = "";
  document.getElementById("resultadoPasaPor").textContent = "";

  cargarMapa(c.nombre);
}

function corregir() {
  const c = dataCarreteras[claves[indice]];

  corregirCampo(
    "inputMunicipios",
    "resultadoMunicipios",
    c.municipios
  );

  corregirCampo(
    "inputPasaPor",
    "resultadoPasaPor",
    c.pasaPor
  );
}

function corregirCampo(inputId, resultadoId, solucion) {
  const respuesta = document.getElementById(inputId)
    .value.split(",")
    .map(e => e.trim().toLowerCase())
    .filter(e => e !== "");

  const correctas = solucion.map(e => e.toLowerCase());

  let aciertos = respuesta.filter(r => correctas.includes(r)).length;

  document.getElementById(resultadoId).innerHTML =
    `<span class="correcto">‚úî ${aciertos}</span> / ${solucion.length}`;
}

function mostrarSolucion() {
  const c = dataCarreteras[claves[indice]];

  document.getElementById("resultadoMunicipios").textContent =
    c.municipios.join(", ");

  document.getElementById("resultadoPasaPor").textContent =
    c.pasaPor.join(", ");

  document.getElementById("inicio").textContent = c.inicio;
  document.getElementById("final").textContent = c.final;
}

// ===============================
// MAPA ‚Äì FUTURO GEOJSON
// ===============================
function cargarMapa(nombre) {
  if (capaCarretera) {
    mapa.removeLayer(capaCarretera);
  }

  // Placeholder: centro visual
  capaCarretera = L.circle([29.05, -13.63], {
    radius: 2000,
    color: 'red'
  }).addTo(mapa);
}

// ===============================
// NAVEGACI√ìN
// ===============================
function siguiente() {
  indice = (indice + 1) % claves.length;
  mostrarCarretera();
}

function anterior() {
  indice = (indice - 1 + claves.length) % claves.length;
  mostrarCarretera();
}

// ARRANQUE
mostrarCarretera();
</script>

</body>
</html>
